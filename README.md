# 电力用户窃电检测与定位装置开发与应用 
*Power-Theft-Detection-and-Localization-System*

## 📖 项目简介
《电力用户窃电检测与定位装置开发与应用》项目由安徽百舸争流信息科技有限公司委托实验室开发，旨在检测电力用户是否存在偷电或漏电行为。系统通过采集电流、电压、功率、频率等电力参数，并将采集的电力数据实时传输至云端平台，结合窃电检测算法生成检测结果，最终将结果反馈至移动端。整个系统采集误差低于1%。在测试阶段，项目累计发现窃电用户约50户，累计挽回经济损失约5万元，现已交付公司并稳定运行。

## ⚙️ 功能简介
本项目以**STM32** 单片机为主控核心，集成**RN8302** 电能计量芯片，通过**SPI** 通信协议实现高精度电能数据采集。采集的数据通过**BC20** 通信模块，采用**MQTT** 协议远程上传至云端。云服务器部署窃电检测算法，对上传数据进行分析，并将检测结果写入数据库。最终，用户可通过微信小程序进行设备管理及电能数据可视化。整个系统可具体划分为采集端、云服务器端和移动端三部分。
### 1. 采集端
- **主控芯片**： STM32F103C8T6  
- **电能采集芯片**： RN8302B（SPI 通信）  
- **通信模块**： Quectel BC20（AT 指令）  
- **采集数据类型**：电压、电流、频率  
### 2. 云服务器端
- **平台**： 京东云  
- **组件部署**：
  - EMQX：处理 MQTT 消息收发  
  - MySQL：存储历史数据与窃电检测结果  
  - Python：运行窃电检测算法（互相关 + LSTM）  
  - 后台管理系统：用户授权、设备管理与数据可视化  
### 3. 移动端（微信小程序）
- 采集设备安装与管理（扫码 + 地图定位）  
- 设备远程控制（控制报警器）  
- 电能数据可视化查询  
- 窃电检测结果展示

## 🔧 开发与部署说明
### 工程文件
- 采集端固件工程：`MQTT_HAL_RN8302B_FreeRTOS_V3.0_REC`（Keil 工程）  
- PCB 设计：`Power-Theft-Detection-and-Localization-System.eprj`（嘉立创 EDA 专业版）   
### 云服务器配置
- Python 3.8+
- MySQL  5.7.42
- EMQX   5.6.1
- 推荐环境：Ubuntu 20.04 LTS
